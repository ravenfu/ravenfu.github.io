<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 4.2.1">
  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon.ico">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon.ico">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">


<link rel="stylesheet" href="/lib/font-awesome/css/all.min.css">
  <link rel="stylesheet" href="//cdn.jsdelivr.net/gh/fancyapps/fancybox@3/dist/jquery.fancybox.min.css">

<script id="hexo-configurations">
    var NexT = window.NexT || {};
    var CONFIG = {"hostname":"ravenfu.github.io","root":"/","scheme":"Pisces","version":"7.8.0","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12,"onmobile":false},"copycode":{"enable":false,"show_result":false,"style":null},"back2top":{"enable":true,"sidebar":false,"scrollpercent":false},"bookmark":{"enable":false,"color":"#222","save":"auto"},"fancybox":true,"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"algolia":{"hits":{"per_page":10},"labels":{"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}},"localsearch":{"enable":true,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false},"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},"path":"search.xml"};
  </script>

  <meta property="og:type" content="website">
<meta property="og:title" content="Raven&#39;s Wiki">
<meta property="og:url" content="https://ravenfu.github.io/page/40/">
<meta property="og:site_name" content="Raven&#39;s Wiki">
<meta property="og:locale" content="zh_CN">
<meta property="article:author" content="Raven">
<meta name="twitter:card" content="summary">

<link rel="canonical" href="https://ravenfu.github.io/page/40/">


<script id="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome : true,
    isPost : false,
    lang   : 'zh-CN'
  };
</script>

  <title>Raven's Wiki</title>
  






  <noscript>
  <style>
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

</head>

<body itemscope itemtype="http://schema.org/WebPage">
  <div class="container use-motion">
    <div class="headband"></div>

    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="切换导航栏">
      <span class="toggle-line toggle-line-first"></span>
      <span class="toggle-line toggle-line-middle"></span>
      <span class="toggle-line toggle-line-last"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <h1 class="site-title">Raven's Wiki</h1>
      <span class="logo-line-after"><i></i></span>
    </a>
      <p class="site-subtitle" itemprop="description">清风皓月任我飞~~~</p>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
        <i class="fa fa-search fa-fw fa-lg"></i>
    </div>
  </div>
</div>




<nav class="site-nav">
  <ul id="menu" class="main-menu menu">
        <li class="menu-item menu-item-home">

    <a href="/" rel="section"><i class="fa fa-home fa-fw"></i>首页</a>

  </li>
        <li class="menu-item menu-item-tags">

    <a href="/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>标签</a>

  </li>
        <li class="menu-item menu-item-categories">

    <a href="/categories/" rel="section"><i class="fa fa-th fa-fw"></i>分类</a>

  </li>
        <li class="menu-item menu-item-archives">

    <a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>归档</a>

  </li>
        <li class="menu-item menu-item-about">

    <a href="/about/" rel="section"><i class="fa fa-user fa-fw"></i>关于</a>

  </li>
      <li class="menu-item menu-item-search">
        <a role="button" class="popup-trigger"><i class="fa fa-search fa-fw"></i>搜索
        </a>
      </li>
  </ul>
</nav>



  <div class="search-pop-overlay">
    <div class="popup search-popup">
        <div class="search-header">
  <span class="search-icon">
    <i class="fa fa-search"></i>
  </span>
  <div class="search-input-container">
    <input autocomplete="off" autocapitalize="off"
           placeholder="搜索..." spellcheck="false"
           type="search" class="search-input">
  </div>
  <span class="popup-btn-close">
    <i class="fa fa-times-circle"></i>
  </span>
</div>
<div id="search-result">
  <div id="no-result">
    <i class="fa fa-spinner fa-pulse fa-5x fa-fw"></i>
  </div>
</div>

    </div>
  </div>

</div>
    </header>

    
  <div class="back-to-top">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>


    <main class="main">
      <div class="main-inner">
        <div class="content-wrap">
          

          <div class="content index posts-expand">
            
      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://ravenfu.github.io/posts/tool/433da766/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.jpg">
      <meta itemprop="name" content="Raven">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Raven's Wiki">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/posts/tool/433da766/" class="post-title-link" itemprop="url">wine-setup</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2017-10-06 22:49:49" itemprop="dateCreated datePublished" datetime="2017-10-06T22:49:49+08:00">2017-10-06</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2020-09-11 15:57:01" itemprop="dateModified" datetime="2020-09-11T15:57:01+08:00">2020-09-11</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/tool/" itemprop="url" rel="index"><span itemprop="name">tool</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h3 id="安装">0.0.1.  安装</h3>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"># 查看架构</span><br><span class="line">dpkg --print-architecture</span><br><span class="line"># 添加 i386</span><br><span class="line">sudo dpkg --add-architecture i386 &amp;&amp; sudo apt update</span><br><span class="line"># 安装</span><br><span class="line">sudo apt install wine wine32 wine64 libwine libwine:i386 fonts-wine</span><br><span class="line">sudo apt install wine-development wine32-development wine64-development libwine-development libwine-development:i386 fonts-wine</span><br><span class="line">sudo apt install winetrick</span><br></pre></td></tr></table></figure>
<h3 id="使用">0.0.2.  使用</h3>
<h5 id="选择版本">0.0.2.0.1.  选择版本</h5>
<p>选择稳定版or开发版</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo update-alternatives --config wine</span><br></pre></td></tr></table></figure>
<h5 id="配置wine">0.0.2.0.2.  配置wine</h5>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"># 配置窗口</span><br><span class="line">winecfg</span><br><span class="line"># 配置注册表</span><br><span class="line">regedit</span><br></pre></td></tr></table></figure>
<h5 id="安装软件">0.0.2.0.3.  安装软件</h5>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">wine setup.exe</span><br></pre></td></tr></table></figure>
<h5 id="卸载软件">0.0.2.0.4.  卸载软件</h5>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"># uninstaller 不能完全删除菜单和桌面图标, 必须手动删除</span><br><span class="line">wine uninstaller</span><br></pre></td></tr></table></figure>
<h3 id="resource">0.0.3.  Resource</h3>
<ul>
<li>winehq download<br>
<a href="https://www.winehq.org/download" target="_blank" rel="noopener">https://www.winehq.org/download</a></li>
<li>winehq debian install<br>
<a href="https://wiki.winehq.org/Debian" target="_blank" rel="noopener">https://wiki.winehq.org/Debian</a></li>
<li>debian wiki (老版本安装)<br>
<a href="https://wiki.debian.org/Wine" target="_blank" rel="noopener">https://wiki.debian.org/Wine</a></li>
</ul>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://ravenfu.github.io/posts/tool/d5d6b05b/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.jpg">
      <meta itemprop="name" content="Raven">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Raven's Wiki">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/posts/tool/d5d6b05b/" class="post-title-link" itemprop="url">wget</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2017-10-06 21:22:45" itemprop="dateCreated datePublished" datetime="2017-10-06T21:22:45+08:00">2017-10-06</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2020-09-11 15:57:12" itemprop="dateModified" datetime="2020-09-11T15:57:12+08:00">2020-09-11</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/tool/" itemprop="url" rel="index"><span itemprop="name">tool</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h3 id="常用命令选项">0.0.1.  常用命令选项</h3>
<p>-c  断点续传<br>
-t  重试次数, 0 表示不限次数<br>
-T  等待超时时间<br>
-o  保存到目录</p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://ravenfu.github.io/posts/tool/3e01b4d/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.jpg">
      <meta itemprop="name" content="Raven">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Raven's Wiki">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/posts/tool/3e01b4d/" class="post-title-link" itemprop="url">curl</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2017-10-06 19:25:11" itemprop="dateCreated datePublished" datetime="2017-10-06T19:25:11+08:00">2017-10-06</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2020-09-11 15:57:11" itemprop="dateModified" datetime="2020-09-11T15:57:11+08:00">2020-09-11</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/tool/" itemprop="url" rel="index"><span itemprop="name">tool</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1 id="常用命令选项">1.  常用命令选项</h1>
<p>-f  连接失败时不显示http错误<br>
-s  静音模式.不输出任何东西<br>
-I  显示 Header 信息, 但是不能和 -F (上传文件) 一起使用<br>
-S  显示错误<br>
-L  当页面有跳转的时候, 输出跳转到的页面<br>
-d  POST方式传送数据<br>
-A  user-agent<br>
-H  header <a href="key:value">key:value</a><br>
-X  method<br>
-k 不效验 https 证书<br>
-c cookie.txt 将 cookie 保存到 cookie.txt<br>
-b cookie.txt 使用 cookie.txt 的内容做为 cookie<br>
-o 指定输出路径, <code>-</code> 表示输出到控制台</p>
<h1 id="获取ip">2.  获取IP</h1>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"># curl ipinfo.io</span><br><span class="line">&#123;</span><br><span class="line">  &quot;ip&quot;: &quot;114.110.1.38&quot;,</span><br><span class="line">  &quot;hostname&quot;: &quot;No Hostname&quot;,</span><br><span class="line">  &quot;city&quot;: &quot;Beijing&quot;,</span><br><span class="line">  &quot;region&quot;: &quot;Beijing Shi&quot;,</span><br><span class="line">  &quot;country&quot;: &quot;CN&quot;,</span><br><span class="line">  &quot;loc&quot;: &quot;39.9289, 116.3883&quot;,</span><br><span class="line">  &quot;org&quot;: &quot;AS4808 CNCGROUP IP network China169 Beijing Province Network&quot;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"># curl ip.cn</span><br><span class="line">当前 IP: 114.110.1.38 来自: 北京市 广东恒敦通信技术北京分公司</span><br><span class="line"></span><br><span class="line"># curl cip.cc</span><br><span class="line">IP  : 114.110.1.38</span><br><span class="line">地址  : 中国  北京市</span><br><span class="line">数据二 : 北京市 | 广东恒敦通信技术北京分公司</span><br><span class="line">URL : http:&#x2F;&#x2F;www.cip.cc&#x2F;114.110.1.38</span><br><span class="line"></span><br><span class="line"># curl myip.ipip.net</span><br><span class="line">当前 IP: 114.110.1.38  来自于: 中国 北京 北京 联通&#x2F;电信</span><br><span class="line"></span><br><span class="line"># curl ifconfig.me</span><br><span class="line">114.110.1.38</span><br><span class="line"></span><br><span class="line"># curl http:&#x2F;&#x2F;members.3322.org&#x2F;dyndns&#x2F;getip</span><br><span class="line">114.110.1.38</span><br></pre></td></tr></table></figure>
<h1 id="样例">3.  样例</h1>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">curl -x socks5:&#x2F;&#x2F;127.0.0.1:1080 http:&#x2F;&#x2F;www.baidu.com</span><br></pre></td></tr></table></figure>
<h1 id="resource">4.  Resource</h1>
<ul>
<li>man<br>
<a href="http://man.linuxde.net/curl" target="_blank" rel="noopener">http://man.linuxde.net/curl</a></li>
</ul>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://ravenfu.github.io/posts/docker/f255ffad/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.jpg">
      <meta itemprop="name" content="Raven">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Raven's Wiki">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/posts/docker/f255ffad/" class="post-title-link" itemprop="url">docker</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2017-10-06 15:44:20" itemprop="dateCreated datePublished" datetime="2017-10-06T15:44:20+08:00">2017-10-06</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2020-09-11 15:49:38" itemprop="dateModified" datetime="2020-09-11T15:49:38+08:00">2020-09-11</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/docker/" itemprop="url" rel="index"><span itemprop="name">docker</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1 id="安装">1.  安装</h1>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 删除老版本</span></span><br><span class="line">sudo apt-get remove docker docker-engine docker.io</span><br><span class="line"></span><br><span class="line"><span class="comment"># 安装</span></span><br><span class="line">sudo apt install apt-transport-https ca-certificates curl gnupg2 software-properties-common</span><br><span class="line">curl -fsSL https://download.docker.com/linux/debian/gpg | sudo apt-key add -</span><br><span class="line">sudo add-apt-repository <span class="string">"deb [arch=amd64] https://download.docker.com/linux/debian <span class="variable">$(lsb_release -cs)</span> stable"</span></span><br><span class="line">sudo apt update</span><br><span class="line">sudo apt install docker-ce</span><br><span class="line"></span><br><span class="line"><span class="comment"># 添加docker组</span></span><br><span class="line"><span class="comment"># sudo groupadd docker</span></span><br><span class="line"><span class="comment"># sudo gpasswd -a $&#123;USER&#125; docker</span></span><br><span class="line"><span class="comment"># sudo systemctl restart docker</span></span><br><span class="line"><span class="comment"># 切换当前会话到新 group 或者重启 X 会话</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 查看当前用户所在的所有用户组</span></span><br><span class="line">groups</span><br><span class="line"><span class="comment"># 将用户添加到 docker 用户组</span></span><br><span class="line">sudo usermod -a -G docker &lt;username&gt;</span><br><span class="line"><span class="comment"># 刷新</span></span><br><span class="line">newgrp - docker</span><br></pre></td></tr></table></figure>
<h1 id="镜像">2.  镜像</h1>
<p>通过修改镜像源地址, 加快镜像下载速度.<br>
镜像源配置文件是: <code>/etc/docker/daemon.json</code></p>
<ol>
<li>使用daoCloud的镜像加速器</li>
</ol>
<h5 id="修改方法">2.0.0.0.1.  修改方法</h5>
<p>不同环境可查看 <a href="https://www.daocloud.io/mirror#accelerator-doc" target="_blank" rel="noopener">https://www.daocloud.io/mirror#accelerator-doc</a></p>
<p>在linux下使用如下命令配置:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">curl -sSL https:&#x2F;&#x2F;get.daocloud.io&#x2F;daotools&#x2F;set_mirror.sh | sh -s http:&#x2F;&#x2F;85ad13ff.m.daocloud.io</span><br></pre></td></tr></table></figure>
<ol start="2">
<li>阿里云镜像加速器</li>
</ol>
<p>注册 <code>https://cr.console.aliyun.com/</code><br>
之后访问 <code>https://cr.console.aliyun.com/#/accelerator</code><br>
获得专属加速器<br>
/etc/docker/daemon.json</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  &quot;registry-mirrors&quot;: [&quot;https:&#x2F;&#x2F;61mj61jz.mirror.aliyuncs.com&quot;]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">sudo systemctl daemon-reload</span><br><span class="line">sudo systemctl restart docker</span><br></pre></td></tr></table></figure>
<h1 id="网络">3.  网络</h1>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker run --net=bridge</span><br></pre></td></tr></table></figure>
<h1 id="修改docker的默认镜像存储位置">4.  修改Docker的默认镜像存储位置</h1>
<p>可能会需要镜像太多, 或者磁盘分配太小, 之后导致无法再下载镜像,或者容器无法启动.<br>
我们可能需要将镜像存储位置移动到其他文件目录下.</p>
<p>默认镜像存储位置是 <code>/var/lib/docker</code></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 通过该命令查看默认镜像存储位置</span></span><br><span class="line">docker info | grep <span class="string">'Docker Root Dir'</span></span><br></pre></td></tr></table></figure>
<h2 id="方式-1-修改docker的默认镜像存储位置">4.1.  方式 1: 修改Docker的默认镜像存储位置</h2>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 停止服务</span></span><br><span class="line">systemctl stop docker</span><br><span class="line"></span><br><span class="line"><span class="comment"># 对之前的数据做个文件备份, 如果有把握可以跳过</span></span><br><span class="line">tar -zcC /var/lib/docker &gt;/mnt/var_lib_docker-backup-$(date + %s).tar.gz</span><br><span class="line"></span><br><span class="line"><span class="comment"># 迁移整个/var/lib/docker目录到目的路径</span></span><br><span class="line">mv /var/lib/docker /home/raven/Package/docker</span><br><span class="line"></span><br><span class="line"><span class="comment"># 建立symlink软链接</span></span><br><span class="line">ln -s /data/tools/docke /var/lib/docker</span><br><span class="line"></span><br><span class="line"><span class="comment"># 确认文件夹类型为symlink 类型</span></span><br><span class="line">ls -al /var/lib/docker</span><br><span class="line"></span><br><span class="line"><span class="comment"># 重启服务</span></span><br><span class="line">sudo systemctl start docker</span><br></pre></td></tr></table></figure>
<h2 id="方式-2-修改镜像和容器的默认存放路径">4.2.  方式 2:  修改镜像和容器的默认存放路径</h2>
<p>在 <code>/etc/default/docker</code> 中修改</p>
<blockquote>
<p>DOCKER_OPTS=&quot;-g /home/raven/Package/docker&quot;</p>
</blockquote>
<p>之后重启服务</p>
<p>或者 修改 <code>/etc/docker/daemon.json</code></p>
<blockquote>
<p>{“registry-mirrors”: [“http://***.***.com”],“graph”:&quot;/home/raven/Packages/docker&quot;}</p>
</blockquote>
<p>修改后立即生效</p>
<h1 id="容器管理工具">5.  容器管理工具</h1>
<p>以下 3 个工具都能通过文件配置管理与发布 Docker 容器.</p>
<h2 id="docker-compose">5.1.  Docker Compose</h2>
<p>Docker Compose 只能管理当前主机上的容器</p>
<h2 id="docker-swarm">5.2.  Docker Swarm</h2>
<p>Docker Swarm 能管理多主机上的容器, 是由 Docker 公司开发的</p>
<h2 id="kubernates">5.3.  Kubernates</h2>
<p>Kubernates 也能管理多主机上的容器, 是有谷歌开发的.<br>
Kubernates 比 Docker Swarm 更主流有点, 目前很多大公司使用它作为默认容器管理工具.</p>
<h1 id="problem">6.  Problem</h1>
<h2 id="1-动态设置-容器最大内存">6.1.  1. 动态设置 容器最大内存</h2>
<p>在部署docker应用,  应用编排时都需要指定一个内存的最大使用上限.<br>
如果应用使用的内存超过了配额, 镜像会被kill掉.<br>
所以java微服务应用, 有必要设置应用自己的最大内存.</p>
<p>docker镜像服务的内存不能全部给 <em>-Xmx</em> , 因为JVM消耗的内存不仅仅是Heap.</p>
<p>JVM = Heap + Method Area +Constant Pool + Thread Stack * num of thread .</p>
<p>Xmx的值可设置为镜像上限减去150m或200m.<br>
当然还需要考虑应用自身的特点, 比如class数目, 并发线程数等.</p>
<p>通过 cgroups 动态获取容器资源配置</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># git memory limit size</span></span><br><span class="line">limit_in_bytes=$(cat /sys/fs/cgroup/memory/memory.limit_in_bytes)</span><br><span class="line"></span><br><span class="line"><span class="comment"># If not default limit_in_bytes in cgroup</span></span><br><span class="line"><span class="keyword">if</span> [ <span class="string">"<span class="variable">$limit_in_bytes</span>"</span> -ne <span class="string">"9223372036854771712"</span> ]</span><br><span class="line"><span class="keyword">then</span></span><br><span class="line">    limit_in_megabytes=$(expr <span class="variable">$limit_in_bytes</span> \/ 1048576)</span><br><span class="line">    heap_size=$(expr <span class="variable">$limit_in_megabytes</span> - <span class="variable">$RESERVED_MEGABYTES</span>)</span><br><span class="line">    <span class="built_in">export</span> JAVA_OPTS=<span class="string">"-Xmx<span class="variable">$&#123;heap_size&#125;</span>m <span class="variable">$JAVA_OPTS</span>"</span></span><br><span class="line">    <span class="built_in">echo</span> JAVA_OPTS=<span class="variable">$JAVA_OPTS</span></span><br><span class="line"><span class="keyword">fi</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># start tomcat</span></span><br></pre></td></tr></table></figure>
<h1 id="常见问题">7.  常见问题</h1>
<h2 id="docker-杀死容器">7.1.  docker 杀死容器</h2>
<p>解决办法, 调整容器分配的内存到 1280m , 调整jvm分配的内存, 大致参数如下:</p>
<p>-Xms512m -Xmx512m -XX:ReservedCodeCacheSize=128m -XX:+UseCodeCacheFlushing -XX:MetaspaceSize=192m -XX:MaxMetaspaceSize=192m -XX:MaxDirectMemorySize=64m</p>
<p>明确已知内存 512m + 128m + 192m + 64m 共 896m,</p>
<p>另外线程预留 128m  (预留 200线程, 每线程 512k)</p>
<p>剩余 256m 作为余量</p>
<h1 id="resource">8.  Resource</h1>
<ul>
<li>
<p>doc<br>
<a href="https://docs.docker.com/engine/installation/linux/docker-ce/debian/#install-using-the-repository" target="_blank" rel="noopener">https://docs.docker.com/engine/installation/linux/docker-ce/debian/#install-using-the-repository</a><br>
<a href="https://docs.docker.com/reference/" target="_blank" rel="noopener">https://docs.docker.com/reference/</a></p>
</li>
<li>
<a href="https://yq.aliyun.com/articles/233839?spm=5176.10695662.1996646101.searchclickresult.7cb74579zzEffo" target="_blank" rel="noopener" title target>Docker 加速器</a>
</li>
<li>
<p><a href="https://www.cnblogs.com/ilinuxer/p/6648681.html" target="_blank" rel="noopener">https://www.cnblogs.com/ilinuxer/p/6648681.html</a></p>
</li>
<li>
<p><a href="https://github.com/maqian/toolbox" target="_blank" rel="noopener">https://github.com/maqian/toolbox</a></p>
</li>
<li>
<a href="http://www.cnblogs.com/xuxinkun/p/5541894.html" target="_blank" rel="noopener" title target>Docker容器内存监控</a></li>
</ul>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://ravenfu.github.io/posts/tool/ab21860c/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.jpg">
      <meta itemprop="name" content="Raven">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Raven's Wiki">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/posts/tool/ab21860c/" class="post-title-link" itemprop="url">Hexo</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2017-10-06 15:23:33" itemprop="dateCreated datePublished" datetime="2017-10-06T15:23:33+08:00">2017-10-06</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2020-09-11 16:46:22" itemprop="dateModified" datetime="2020-09-11T16:46:22+08:00">2020-09-11</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/tool/" itemprop="url" rel="index"><span itemprop="name">tool</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1 id="安装">1.  安装</h1>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">npm install -g hexo-cli</span><br><span class="line">cd your-blog</span><br><span class="line">hexo init</span><br></pre></td></tr></table></figure>
<h1 id="常用命令选项">2.  常用命令选项</h1>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">d, deploy    Deploy your website.</span><br><span class="line">g, generate  Generate static files.</span><br><span class="line">n, new       Create a new post.</span><br><span class="line">s, server    Start the server.</span><br><span class="line">clean     Remove generated files and cache.</span><br><span class="line">config    Get or set configurations.</span><br><span class="line">help      Get help on a command.</span><br><span class="line">init      Create a new Hexo folder.</span><br><span class="line">list      List the information of the site</span><br><span class="line">migrate   Migrate your site from other system to Hexo.</span><br><span class="line">publish   Moves a draft post from \_drafts to \_posts folder.</span><br><span class="line">render    Render files with renderer plugins.</span><br><span class="line">version   Display version information.</span><br></pre></td></tr></table></figure>
<h1 id="常用插件">3.  常用插件</h1>
<ul>
<li>hexo-abbrlink 链接地址优化</li>
<li>hexo-pdf 支持pdf</li>
<li>hexo-deployer-git 用git发布</li>
<li>hexo-generator-searchdb 支持本地搜索</li>
<li>hexo-footnotes 支持脚注 (脚注非 markdown 原生语法, 需要插件支持)</li>
<li>hexo-tag-plantuml 画UML图</li>
<li>hexo-tag-echarts3 支持EChart</li>
<li>hexo-heading-index 标题自动添加序号</li>
</ul>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cnpm i -S hexo-abbrlink hexo-pdf hexo-deployer-git hexo-generator-searchdb hexo-footnotes hexo-tag-plantuml hexo-tag-echarts3 hexo-heading-index</span><br></pre></td></tr></table></figure>
<h1 id="最好用的主题">4.  最好用的主题</h1>
<p>next-Pisces 主题简洁大方, 功能丰富, 翻了多个主题, 就这个最方便了.<br>
自带 mathjax.</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">cd $blog_dir</span><br><span class="line">git clone -b master --depth&#x3D;1 https:&#x2F;&#x2F;github.com&#x2F;theme-next&#x2F;hexo-theme-next themes&#x2F;next</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">git clone -b master --depth&#x3D;1 https:&#x2F;&#x2F;github.com&#x2F;theme-next&#x2F;hexo-theme-next next</span><br><span class="line">ln -sf next $blog_dir&#x2F;themes&#x2F;next</span><br><span class="line">ln -sf $DOCS_DIR&#x2F;next $DOCS_DIR&#x2F;blog&#x2F;themes&#x2F;next</span><br></pre></td></tr></table></figure>
<p>之后添加 ${your-blog}/source/_posts/_data/next.yml, 用于覆盖 theme/next/_config.yml</p>
<h1 id="常见问题">5.  常见问题</h1>
<h2 id="数据表达式支持">5.1.  数据表达式支持</h2>
<ol>
<li>${your-blog}/source/_posts/_data/next.yml 文件中打开数据表达式支持</li>
</ol>
<figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">math:</span></span><br><span class="line">  <span class="attr">katex:</span></span><br><span class="line">    <span class="attr">enable:</span> <span class="literal">true</span></span><br></pre></td></tr></table></figure>
<ol start="2">
<li>把 hexo-renderer-marked 卸载</li>
</ol>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">cnpm un -S hexo-renderer-marked</span><br><span class="line">cnpm i -S hexo-renderer-markdown-it-plus</span><br></pre></td></tr></table></figure>
<ol start="3">
<li>在博客文件头中添加标识 <code>mathjax: true</code></li>
</ol>
<p>之后在博客文件正文就可以写数学表达式了, 如:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">单行数学表达式:</span><br><span class="line">$a \ne 0$</span><br><span class="line"></span><br><span class="line">多行数学表达式:</span><br><span class="line">$$</span><br><span class="line">\begin&#123;aligned&#125;</span><br><span class="line">a &amp;&#x3D; b + c \\</span><br><span class="line">  &amp;&#x3D; d + e + f + g \\</span><br><span class="line">  &amp;&#x3D; h + i</span><br><span class="line">\end&#123;aligned&#125;</span><br><span class="line">$$</span><br></pre></td></tr></table></figure>
<h2 id="特殊字符转义">5.2.  特殊字符转义</h2>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">! &amp;#33; — 惊叹号 Exclamation mark</span><br><span class="line">” &amp;#34; &quot; 双引号 Quotation mark</span><br><span class="line"># &amp;#35; — 数字标志 Number sign</span><br><span class="line">$ &amp;#36; — 美元标志 Dollar sign</span><br><span class="line">% &amp;#37; — 百分号 Percent sign</span><br><span class="line">&amp; &amp;#38; &amp; Ampersand</span><br><span class="line">‘ &#39; — 单引号 Apostrophe</span><br><span class="line">( &amp;#40; — 小括号左边部分 Left parenthesis</span><br><span class="line">) &amp;#41; — 小括号右边部分 Right parenthesis</span><br><span class="line">* &amp;#42; — 星号 Asterisk</span><br><span class="line">+ &amp;#43; — 加号 Plus sign</span><br><span class="line">&lt; &amp;#60; &lt; 小于号 Less than</span><br><span class="line">&#x3D; &amp;#61; — 等于符号 Equals sign</span><br><span class="line">- &amp;#45; &amp;minus; — 减号</span><br><span class="line">&gt; &amp;#62; &gt; 大于号 Greater than</span><br><span class="line">? &amp;#63; — 问号 Question mark</span><br><span class="line">@ &amp;#64; — Commercial at</span><br><span class="line">[ &amp;#91; --- 中括号左边部分 Left square bracket</span><br><span class="line">\ &amp;#92; --- 反斜杠 Reverse solidus (backslash)</span><br><span class="line">] &amp;#93; — 中括号右边部分 Right square bracket</span><br><span class="line">&#123; &amp;#123; — 大括号左边部分 Left curly brace</span><br><span class="line">| &amp;#124; — 竖线Vertical bar</span><br><span class="line">&#125; &amp;#125; — 大括号右边部分 Right curly brace</span><br></pre></td></tr></table></figure>
<h1 id="resource">6.  Resource</h1>
<ul>
<li>
<a href="https://hexo.io/zh-cn/" target="_blank" rel="noopener" title target>hexo 官网</a>
</li>
<li>
<a href="https://github.com/hexojs/hexo" target="_blank" rel="noopener" title target>hexo 源码</a>
</li>
<li>
<a href="https://github.com/theme-next/hexo-theme-next" target="_blank" rel="noopener" title target>Next</a>
</li>
</ul>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://ravenfu.github.io/posts/nodejs/a1345b2b/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.jpg">
      <meta itemprop="name" content="Raven">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Raven's Wiki">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/posts/nodejs/a1345b2b/" class="post-title-link" itemprop="url">npm</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2017-09-22 18:14:02" itemprop="dateCreated datePublished" datetime="2017-09-22T18:14:02+08:00">2017-09-22</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2020-09-11 16:17:15" itemprop="dateModified" datetime="2020-09-11T16:17:15+08:00">2020-09-11</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/nodejs/" itemprop="url" rel="index"><span itemprop="name">nodejs</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1 id="安装">1.  安装</h1>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># nvm 安装</span></span><br><span class="line"><span class="comment"># https://github.com/nvm-sh/nvm</span></span><br><span class="line">curl -o- https://raw.githubusercontent.com/nvm-sh/nvm/v0.35.3/install.sh | bash</span><br><span class="line">wget -qO- https://raw.githubusercontent.com/nvm-sh/nvm/v0.35.3/install.sh | bash</span><br><span class="line"></span><br><span class="line"><span class="comment"># 由于 nvm 启动比较慢, 所以使用手工方式加载</span></span><br><span class="line"><span class="comment"># 先清理 .bashrc .zshrc 中的 nvm 环境信息</span></span><br><span class="line"><span class="comment"># 在环境配置中添加:</span></span><br><span class="line"><span class="function"><span class="title">snvm</span></span>()&#123;</span><br><span class="line">    <span class="built_in">export</span> NVM_DIR=<span class="string">"<span class="variable">$HOME</span>/.nvm"</span></span><br><span class="line">    [ -s <span class="string">"<span class="variable">$NVM_DIR</span>/nvm.sh"</span> ] &amp;&amp; \. <span class="string">"<span class="variable">$NVM_DIR</span>/nvm.sh"</span>  <span class="comment"># This loads nvm</span></span><br><span class="line">    [ -s <span class="string">"<span class="variable">$NVM_DIR</span>/bash_completion"</span> ] &amp;&amp; \. <span class="string">"<span class="variable">$NVM_DIR</span>/bash_completion"</span>  <span class="comment"># This loads nvm bash_completion</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment"># 下载安装 nodejs</span></span><br><span class="line">nvm ls-remote</span><br><span class="line">nvm install [lastest-version]</span><br><span class="line">nvm install --lts</span><br><span class="line"></span><br><span class="line"><span class="comment"># npm 配置 taobao registry</span></span><br><span class="line">npm config <span class="built_in">set</span> registry https://registry.npm.taobao.org --global</span><br><span class="line">npm config <span class="built_in">set</span> disturl https://npm.taobao.org/dist --global</span><br><span class="line">npm install cnpm -g --registry=http://registry.npm.taobao.org</span><br></pre></td></tr></table></figure>
<h1 id="resource">2.  Resource</h1>
<a href="https://github.com/nvm-sh/nvm/blob/master/README.md" target="_blank" rel="noopener" title target>NVM Guides</a>
<a href="https://cnpmjs.org/" target="_blank" rel="noopener" title target>CNPM</a>
      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://ravenfu.github.io/posts/nodejs/ccd37491/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.jpg">
      <meta itemprop="name" content="Raven">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Raven's Wiki">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/posts/nodejs/ccd37491/" class="post-title-link" itemprop="url">electron</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2017-09-22 16:41:10" itemprop="dateCreated datePublished" datetime="2017-09-22T16:41:10+08:00">2017-09-22</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2020-09-11 15:49:38" itemprop="dateModified" datetime="2020-09-11T15:49:38+08:00">2020-09-11</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/nodejs/" itemprop="url" rel="index"><span itemprop="name">nodejs</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h3 id="resource">0.0.1.  Resource</h3>
<ul>
<li>Electron 官网<br>
<a href="https://electron.atom.io/" target="_blank" rel="noopener">https://electron.atom.io/</a></li>
<li>Electron 原理<br>
<a href="http://cnodejs.org/topic/572c6ee4afd3b34a17ff409d" target="_blank" rel="noopener">http://cnodejs.org/topic/572c6ee4afd3b34a17ff409d</a></li>
<li>electron wechat<br>
<a href="https://github.com/geeeeeeeeek/electronic-wechat" target="_blank" rel="noopener">https://github.com/geeeeeeeeek/electronic-wechat</a></li>
<li>electron 的一些APP, 其中 Friends 比较奇特.<br>
<a href="http://blog.csdn.net/u011483206/article/details/74327939" target="_blank" rel="noopener">http://blog.csdn.net/u011483206/article/details/74327939</a></li>
<li>awesome electron<br>
<a href="https://github.com/sindresorhus/awesome-electron" target="_blank" rel="noopener">https://github.com/sindresorhus/awesome-electron</a></li>
</ul>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://ravenfu.github.io/posts/design/392c4b30/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.jpg">
      <meta itemprop="name" content="Raven">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Raven's Wiki">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/posts/design/392c4b30/" class="post-title-link" itemprop="url">UML</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2017-09-12 11:01:33" itemprop="dateCreated datePublished" datetime="2017-09-12T11:01:33+08:00">2017-09-12</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2020-09-11 15:49:11" itemprop="dateModified" datetime="2020-09-11T15:49:11+08:00">2020-09-11</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/design/" itemprop="url" rel="index"><span itemprop="name">design</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1 id="类">1.  类</h1>
<p>类封装了信息和行为, 是面向对象的重要组成部分, 它是具有相同属性, 操作, 关系对象集合的总称.<br>
在系统中, 每个类都应该具有一定的职责, 职责是指类锁担任的任务. 一个类可以有多个职责, 但设计得好的类一般只有一种职责.<br>
在定义类时, 当类的职责分解为类的属性和操作, 其中属性用于封装数据, 操作用于封装行为.<br>
设计类时面向对象设计中最重要的组成部分, 也是最复杂和最耗时的部分.</p>
<p>在软件系统运行时, 类将被实例化成对象, 对象对应于某个具体的事物. 类是对一组具有相同属性, 表现相同行为的抽象, 对象是类的实例.</p>
<h1 id="类之间的关系">2.  类之间的关系</h1>
<p>按关系的强弱程度依次为: 泛化 = 实现 &gt; 组合 &gt; 聚合 &gt; 关联 &gt; 依赖</p>
<h2 id="泛化-generalization">2.1.  泛化 Generalization</h2>
<p>is-a<br>
是一种继承关系, 表示一般与特殊的关系.它指定了子类如何特例化父类的所有特征和行为.<br>
代码体现: extends</p>
<p>实线, 空心三角箭头指向父类</p>
<img src="http://www.plantuml.com/plantuml/svg/uqhEIImkLWX8B4hDA-62S9mpCdDIkBWWOWesDRgwK240">
<h2 id="实现-realization">2.2.  实现 Realization</h2>
<p>is-a<br>
接口的实现, 是类与接口的关系, 表示接口所有特征和行为的实现.<br>
代码体现: implements</p>
<p>虚线, 空心三角箭头指向接口</p>
<img src="http://www.plantuml.com/plantuml/svg/uyhCAqajIajCJbNmXB6uadCIYuiLF7CBSb9pK_DA4aioy_EukE3o2ZOrUdheqW00">
<h2 id="聚合-aggregation">2.3.  聚合 Aggregation</h2>
<p>has-a<br>
拥有关系, 是关联关系的一种特例, 整体与部分的关系, 且部分可以离开整体而单独存在.<br>
代码体现: 成员变量</p>
<p>实线, 空心菱形箭头指向整体, 普通箭头指向部分</p>
<img src="http://www.plantuml.com/plantuml/svg/utBEIImkLl39J2fABAhaWl2SylEpkRYWOWfAXaeA-Rfs2afvIX0P0000">
<h2 id="组合-composition">2.4.  组合 Composition</h2>
<p>contains-a<br>
拥有关系, 也是关联关系的一种特例, 整体与部分的关系, 但部分不能离开整体而单独存在.它具有比聚合更强的拥有关系, 强调整体与部分的生命周期是一致的.<br>
代码体现: 成员变量</p>
<p>实线, 实心菱形箭头指向整体, 普通箭头指向部分</p>
<img src="http://www.plantuml.com/plantuml/svg/utBEIImkLd3Epor8pAlaWl1SKWiIYqfoK_DAkBYWCWfAXaeAMhfs2afvIiZo0000">
<h2 id="关联-association">2.5.  关联 Association</h2>
<p>拥有关系, 它使一个类知道另一个类的属性和方法.<br>
代码体现: 成员变量</p>
<p>实线, 普通箭头指向被拥有者, 可以是单向的, 也可以是双向的, 甚至是自关联.</p>
<img src="http://www.plantuml.com/plantuml/svg/utBEIImkLWX9JKpEI2tYWl22IqfJKlDAkBYWmWfAXaeAkWfAUKfmgRpyabI5eipqZ1A5_3o5dCoyR2k5f_qzJoTCVDgw-KNZ52weKKxv-TbSN51T47Fim0Q19R2QqZiLmvJWpBpqdDII_3oWKJ2cWeqkaZWsarwqhu8Q0m00">
<h2 id="依赖-dependency">2.6.  依赖 Dependency</h2>
<p>use-a<br>
是一种使用的关系, 即一个类的实现需要另一个类的协助, 所以要尽量不使用双向的互相依赖.<br>
代码体现: 局部变量, 方法的参数或者对静态方法的调用</p>
<p>虚线, 普通箭头指向被使用者</p>
<img src="http://www.plantuml.com/plantuml/svg/uqhEIImkLd3aWj1EN5oE2dfsG1e0">
<h1 id="画图工具">3.  画图工具</h1>
<ul>
<li>yED   免费, 全平台</li>
<li>visio 收费, osx/win</li>
<li>edraw 收费, 全平台</li>
<li>OmniGraffle  收费, osx</li>
<li>Camunda      收费, win/linux</li>
<li><a href="http://draw.io" target="_blank" rel="noopener">draw.io</a>   online<br>
<a href="https://app.diagrams.net/" target="_blank" rel="noopener">https://app.diagrams.net/</a></li>
<li>lucidchart    online<br>
<a href="https://www.lucidchart.com/" target="_blank" rel="noopener">https://www.lucidchart.com/</a></li>
<li>ProcessOn online</li>
</ul>
<h1 id="resource">4.  Resource</h1>
<ul>
<li><a href="https://www.cnblogs.com/hoojo/p/uml_design.html" target="_blank" rel="noopener">https://www.cnblogs.com/hoojo/p/uml_design.html</a></li>
<li><a href="https://www.omg.org/spec/UML/" target="_blank" rel="noopener">https://www.omg.org/spec/UML/</a></li>
<li><a href="https://www.uml-diagrams.org/uml-25-diagrams.html" target="_blank" rel="noopener">https://www.uml-diagrams.org/uml-25-diagrams.html</a></li>
<li><a href="https://www.uml-diagrams.org/class-reference.html" target="_blank" rel="noopener">https://www.uml-diagrams.org/class-reference.html</a></li>
<li><a href="https://blog.csdn.net/qq_35559756/article/details/78245204" target="_blank" rel="noopener">https://blog.csdn.net/qq_35559756/article/details/78245204</a></li>
</ul>
<h1 id="趣闻">5.  趣闻</h1>
<a href="https://www.uml-diagrams.org/association.html?context=class-diagrams" target="_blank" rel="noopener" title target>UML 官方文档</a> 中嘲讽维基百科: 搞不懂你们是从哪里听来的
<blockquote>
<p>UML specification categorizes association as semantic relationship. Some other UML sources also categorize association as a structural relationship.<br>
Wikipedia states that association is instance level relationship and that associations can only be shown on class diagrams.<br>
Not sure where they got that information from but it is not based on UML specification. Association could be used on different types of UML structure diagrams</p>
</blockquote>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://ravenfu.github.io/posts/security/20fa7c9d/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.jpg">
      <meta itemprop="name" content="Raven">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Raven's Wiki">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/posts/security/20fa7c9d/" class="post-title-link" itemprop="url">cipher</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2017-09-07 16:47:27" itemprop="dateCreated datePublished" datetime="2017-09-07T16:47:27+08:00">2017-09-07</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2020-09-11 15:49:34" itemprop="dateModified" datetime="2020-09-11T15:49:34+08:00">2020-09-11</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/security/" itemprop="url" rel="index"><span itemprop="name">security</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p>加密算法可分:  可逆算法和不可逆算法, 其中可逆算法又可分: 对称加密和非对称加密.</p>
<p>对称加密<br>
指加密和解密使用相同密钥的加密算法.对称加密算法的优点在于加解密的高速度和使用长密钥时的难破解性.假设两个用户需要使用对称加密方法加密然后交换数据, 则用户最少需要2个密钥并交换使用, 如果企业内用户有n个, 则整个企业共需要n×(n-1) 个密钥, 密钥的生成和分发将成为企业信息部门的恶梦.对称加密算法的安全性取决于加密密钥的保存情况, 但要求企业中每一个持有密钥的人都保守秘密是不可能的, 他们通常会有意无意的把密钥泄漏出去——如果一个用户使用的密钥被入侵者所获得, 入侵者便可以读取该用户密钥加密的所有文档, 如果整个企业共用一个加密密钥, 那整个企业文档的保密性便无从谈起.<br>
常见的对称加密算法: DES, 3DES, DESX, Blowfish, IDEA, RC4, RC5, RC6和AES</p>
<p>非对称加密<br>
指加密和解密使用不同密钥的加密算法, 也称为公私钥加密.假设两个用户要加密交换数据, 双方交换公钥, 使用时一方用对方的公钥加密, 另一方即可用自己的私钥解密.如果企业中有n个用户, 企业需要生成n对密钥, 并分发n个公钥.由于公钥是可以公开的, 用户只要保管好自己的私钥即可, 因此加密密钥的分发将变得十分简单.同时, 由于每个用户的私钥是唯一的, 其他用户除了可以可以通过信息发送者的公钥来验证信息的来源是否真实, 还可以确保发送者无法否认曾发送过该信息.非对称加密的缺点是加解密速度要远远慢于对称加密, 在某些极端情况下, 甚至能比非对称加密慢上1000倍.<br>
常见的非对称加密算法: RSA, ECC(移动设备用), Diffie-Hellman, El Gamal, DSA(数字签名用)</p>
<p>Hash算法<br>
Hash算法特别的地方在于它是一种单向算法, 用户可以通过Hash算法对目标信息生成一段特定长度的唯一的Hash值, 却不能通过这个Hash值重新获得目标信息.因此Hash算法常用在不可还原的密码存储, 信息完整性校验等.<br>
常见的Hash算法: MD2, MD4, MD5, HAVAL, SHA, SHA-1, HMAC, HMAC-MD5, HMAC-SHA1</p>
<pre><code>加密算法的效能通常可以按照算法本身的复杂程度, 密钥长度(密钥越长越安全), 加解密速度等来衡量.上述的算法中, 除了DES密钥长度不够, MD2速度较慢已逐渐被淘汰外, 其他算法仍在目前的加密系统产品中使用.
</code></pre>
<p>加密算法的选择<br>
前面的章节已经介绍了对称解密算法和非对称加密算法, 有很多人疑惑: 那我们在实际使用的过程中究竟该使用哪一种比较好呢？<br>
我们应该根据自己的使用特点来确定, 由于非对称加密算法的运行速度比对称加密算法的速度慢很多, 当我们需要加密大量的数据时, 建议采用对称加密算法, 提高加解密速度.<br>
对称加密算法不能实现签名, 因此签名只能非对称算法.<br>
由于对称加密算法的密钥管理是一个复杂的过程, 密钥的管理直接决定着他的安全性, 因此当数据量很小时, 我们可以考虑采用非对称加密算法.<br>
在实际的操作过程中, 我们通常采用的方式是: 采用非对称加密算法管理对称算法的密钥, 然后用对称加密算法加密数据, 这样我们就集成了两类加密算法的优点, 既实现了加密速度快的优点, 又实现了安全方便管理密钥的优点.<br>
如果在选定了加密算法后, 那采用多少位的密钥呢？一般来说, 密钥越长, 运行的速度就越慢, 应该根据的我们实际需要的安全级别来选择, 一般来说, RSA建议采用1024位的数字, ECC建议采用160位, AES采用128为即可.</p>
<p>算法选择(从性能和安全性综合)<br>
对称加密: AES(128位),<br>
非对称加密: ECC(160位)或RSA(1024),<br>
消息摘要: MD5<br>
数字签名:DSA</p>
<h1 id="常见加密算法">1.  常见加密算法</h1>
<p>// todo<br>
crc16 crc32</p>
<h3 id="resource">1.0.1.  Resource</h3>
<ul>
<li>常见加密算法的分类与比较<br>
<a href="http://blog.csdn.net/dragon_ton/article/details/46651489" target="_blank" rel="noopener">http://blog.csdn.net/dragon_ton/article/details/46651489</a></li>
</ul>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://ravenfu.github.io/posts/network/3ef665a6/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.jpg">
      <meta itemprop="name" content="Raven">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Raven's Wiki">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/posts/network/3ef665a6/" class="post-title-link" itemprop="url">https</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2017-09-07 16:40:17" itemprop="dateCreated datePublished" datetime="2017-09-07T16:40:17+08:00">2017-09-07</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2020-09-11 15:49:34" itemprop="dateModified" datetime="2020-09-11T15:49:34+08:00">2020-09-11</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/network/" itemprop="url" rel="index"><span itemprop="name">network</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1 id="https">1.  HTTPS</h1>
<p>Secure Hypertext Transfer Protocol, 安全超文本传输协议.<br>
是使用 TLS/SSL 加密的 HTTP 协议, 是 HTTP 的安全版.</p>
<h1 id="tlsssl">2.  TLS/SSL</h1>
<p>TLS/SSL 协议, 即安全传输层协议, 是介于 TCP 和 HTTP 之间的一层安全协议, 不影响原有的 TCP 协议和 HTTP 协议.</p>
<img src="/posts/network/3ef665a6/tls-ssl%E7%9A%84%E4%BD%9C%E7%94%A8.gif" class title="TLS&#x2F;SSL的作用">
<p>TLS/SSL 协议提供服务的主要有:</p>
<ul>
<li>身份验证, 防止劫持</li>
<li>信息加密, 防止窃听</li>
<li>完整性效验, 防止篡改</li>
</ul>
<p>TLS/SSL 可分为2层:</p>
<ul>
<li>Record Protocol, 记录协议<br>
它建立在可靠的传输协议之上, 如 TCP 协议, 为高层协议提供数据封装, 压缩, 加密等基本功能的支持.<br>
主要用来定义传输的格式.</li>
<li>Handshake Protocol, 握手协议<br>
它建立在SSL记录协议之上, 用于在实际的传输开始前, 通信双方进行身份认证, 协商加密算法, 交换加密密钥等.<br>
主要用来协商出一份密钥.</li>
</ul>
<h2 id="tlsssl-工作原理">2.1.  TLS/SSL 工作原理</h2>
<p>TLS/SSL的功能实现主要依赖于三类基本算法: 散列函数 Hash, 对称加密和非对称加密, 其利用非对称加密实现身份认证和密钥协商, 对称加密算法采用协商的密钥对数据加密, 基于散列函数验证信息的完整性.</p>
<img src="/posts/network/3ef665a6/tls-ssl%E5%B7%A5%E4%BD%9C%E5%8E%9F%E7%90%86.gif" class title="TLS&#x2F;SSL工作原理">
<h3 id="非对称加密">2.1.1.  非对称加密</h3>
<p>即常见的 RSA 算法, 还包括 ECC, DH 等算法.<br>
算法特点是, 密钥成对出现, 一般称为公钥(公开)和私钥(保密), 公钥加密的信息只能私钥解开, 私钥加密的信息只能公钥解开.<br>
因此掌握公钥的不同客户端之间不能互相解密信息, 只能和掌握私钥的服务器进行加密通信, 服务器可以实现1对多的通信, 客户端也可以用来验证掌握私钥的服务器身份.<br>
非对称加密的特点是信息传输1对多, 服务器只需要维持一个私钥就能够和多个客户端进行加密通信, 但服务器发出的信息能够被所有的客户端解密, 且该算法的计算复杂, 加密速度慢.</p>
<h3 id="对称加密">2.1.2.  对称加密</h3>
<p>常见的有 AES-CBC, DES, 3DES, AES-GCM等, 相同的密钥可以用于信息的加密和解密, 掌握密钥才能获取信息, 能够防止信息窃听, 通信方式是1对1.<br>
对称加密的优势是信息传输1对1, 需要共享相同的密码, 密码的安全是保证信息安全的基础, 服务器和 N 个客户端通信, 需要维持 N 个密码记录, 且缺少修改密码的机制.</p>
<h3 id="散列函数-hash">2.1.3.  散列函数 Hash</h3>
<p>常见的有 MD5, SHA1, SHA256, 该类函数特点是函数单向不可逆, 对输入非常敏感, 输出长度固定, 针对数据的任何修改都会改变散列函数的结果, 用于防止信息篡改并验证数据的完整性.<br>
在信息传输过程中, 散列函数不能单独实现信息防篡改, 因为明文传输, 中间人可以修改信息之后重新计算信息摘要, 因此需要对传输的信息以及信息摘要进行加密.</p>
<p>结合三类算法的特点, TLS的基本工作方式是, 客户端使用非对称加密与服务器进行通信, 实现身份验证并协商对称加密使用的密钥, 然后对称加密算法采用协商密钥对信息以及信息摘要进行加密通信, 不同的节点之间采用的对称密钥不同, 从而可以保证信息只能通信双方获取.</p>
<h2 id="tlsssl-握手过程">2.2.  TLS/SSL 握手过程</h2>
<img src="/posts/network/3ef665a6/tls-ssl%E6%8F%A1%E6%89%8B%E8%BF%87%E7%A8%8B.png" class title="TLS&#x2F;SSL握手过程">
<h3 id="客户端发起请求">2.2.1.  客户端发起请求</h3>
<p>Client Hello<br>
客户端发起请求, 以明文传输请求信息, 包含信息有:</p>
<ul>
<li>version: 当前支持的最后TLS协议版本</li>
<li>cipher suites: 客户端支持的加密套件列表<br>
每个加密条件对应4个功能组合:
<ul>
<li>Au, 认证算法, 用于身份认证</li>
<li>Key Exchange, 密钥交换算法, 用于密钥协商</li>
<li>Enc, 对称加密算法, 用于信息加密</li>
<li>Mac, 信息摘要算法, 用于完整性效验</li>
</ul>
</li>
<li>compression methods: 支持的压缩算法列表, 用于后续的信息压缩传输</li>
<li>random_client: 用于后续的密钥生成</li>
<li>extensions: 扩展字段, 支持协议与算法的相关参数及其他辅助信息等, 如常见的SNI</li>
</ul>
<h3 id="服务器端回应">2.2.2.  服务器端回应</h3>
<h4 id="server-hello">2.2.2.1.  Server Hello</h4>
<p>服务端返回协商的结果, 包含信息有:</p>
<ul>
<li>version: 使用的协议版本</li>
<li>cipher suite: 选择的加密套件</li>
<li>compression method: 选择的压缩算法</li>
<li>random_server: 用于后续的密钥生成</li>
</ul>
<h4 id="server-certificate">2.2.2.2.  Server Certificate</h4>
<p>服务端配置对应的证书链发送给客户端, 用于身份效验与密钥交换.</p>
<h4 id="server-hello-done">2.2.2.3.  Server Hello Done</h4>
<p>服务端通知客户端 Server Hello 发送结束.</p>
<h4 id="client-certificate-request">2.2.2.4.  Client Certificate Request</h4>
<p>对于非常重要的信息, 服务端需要对客户端进行验证, 保证数据传送给了安全合法的客户端.<br>
服务端发送 client_certificate_request 标识, 请求验证客户端证书.</p>
<h3 id="客户端验证证书">2.2.3.  客户端验证证书</h3>
<p>Certificate Verify<br>
客户端验证证书合法性.<br>
如果验证通过才会进行后续通信, 否则根据错误情况不同做出提示和操作.</p>
<ul>
<li>证书链的可信性 trusted certificate path</li>
<li>证书是否被吊销 revocation</li>
<li>有效期 expiry date</li>
<li>域名 domain</li>
</ul>
<h3 id="客户端回应">2.2.4.  客户端回应</h3>
<h4 id="client-certificate">2.2.4.1.  Client Certificate</h4>
<p>如果服务端需要验证客户端证书, 即双向认证.<br>
认证方式基本相同, 客户端发送 client_certificate 与 certificate_verify_message.<br>
certificate_verify_message 是采用client的私钥加密以及协商的通信信息得到数据, 服务端采用对应的公钥解密并验证.</p>
<h4 id="client-key-exchange">2.2.4.2.  Client Key Exchange</h4>
<p>客户端计算产生随机数 pre_master_secret, 并用证书公钥加密, 发送给服务端.<br>
此时客户端已经获得计算协商密钥的全部信息:两个明文随机数 random_client 与 random_server, 以及自己计算产生的 pre_master_secret<br>
计算得到协商密钥: session_secret = encrypt(random_client, random_server, pre_master_secret)</p>
<h4 id="change-cipher-spec">2.2.4.3.  Change Cipher Spec</h4>
<p>发送 change_cipher_spec 标识, 用于通知服务端后续的通信采用协商的通信密钥和加密算法进行.</p>
<h4 id="encrypt-handshake-message">2.2.4.4.  Encrypt Handshake Message</h4>
<p>客户端结合之前所有通信参数的 hash 值与其他相关信息生成一段数据, 采用协商密钥 session_secret 与算法进行加密, 然后发送给服务器用于数据与握手验证.</p>
<h3 id="服务端最后回应">2.2.5.  服务端最后回应</h3>
<p>服务端用证书私钥解密加密的 pre_master_secret, 并计算出 session_secret.</p>
<p>服务端计算之前所有接收信息的hash值, 然后解密客户端发送的 encrypt_handshake_message, 验证数据和密钥正确性.</p>
<h4 id="change-cipher-spec-2">2.2.5.1.  Change Cipher Spec</h4>
<p>服务端验证通过后, 统一发送 change_cipher_spec, 通知客户端后续的通信采用协商的通信密钥和加密算法进行.</p>
<h4 id="encrypt-handshake-message-2">2.2.5.2.  Encrypt Handshake Message</h4>
<p>服务端也结合之前所有通信参数的 hash 值与其他相关信息生成一段数据, 采用协商密钥 session_secret 与算法进行加密, 然后发送给客户端.</p>
<h3 id="握手结束">2.2.6.  握手结束</h3>
<p>客户端同样计算并验证 encrypt_handshake_message, 验证通过则握手完成.</p>
<h3 id="加密通信">2.2.7.  加密通信</h3>
<p>开始使用协商密钥和算法进行通信.</p>
<h2 id="密钥">2.3.  密钥</h2>
<h3 id="密钥计算">2.3.1.  密钥计算</h3>
<p>密钥计算流程如下:</p>

<ul>
<li>客户端使用 RSA 或 DH 等加密算法生成 pre_master_secret</li>
<li>pre_master_secret 结合 random_client 和 random_server 两个随机数通过 PseudeRandomFunction (PRF)计算得到 master_secret</li>
<li>master_secret 结合 random_client 和 random_server 两个随机数通过迭代计算得到 Key-Material</li>
</ul>
<h3 id="密钥使用">2.3.2.  密钥使用</h3>
<p>密钥经过12轮迭代计算会获得12个hash值, 分组成为6个元素, 列表如下:</p>
<ul>
<li>Client Mac Key</li>
<li>Server Mac Key</li>
<li>Client Encryption Key</li>
<li>Server Encryption Key</li>
<li>Client IV</li>
<li>Server IV</li>
</ul>
<p>其中, Mac Key 用于完整性效验, Encryption Key 用于对称加密, IV 作为加密算法的初始化向量.<br>
用法如下:</p>
<ul>
<li>Mac Key, Encryption Key和IV是一组加密元素, 分别被客户端和服务端使用, 但是则两组元素都被两边同时获取.</li>
<li>客户端使用 client 组元素加密数据, 服务端使用 client 组元素解密; 服务端使用 server 组元素加密数据, 客户使用 server 组元素解密.</li>
<li>双向通信的不同方向使用的密钥不同, 破解通信至少需要破解2次.</li>
<li>MAC 值的计算包括2个 Hash 值: Mac Key 和 Hash(编号, 包类型, 长度, 压缩数据)</li>
</ul>
<h2 id="其他要点">2.4.  其他要点</h2>
<ul>
<li>
<p>pre_master_secret 前2个字节是TLS版本号<br>
这是一个比较重要的用来核对握手数据的版本号.<br>
因为在 Client Hello 阶段, 客户端会发送一份加密套件列表和定钱支持的 TLS/SSL 的版本号给服务端, 而且是使用明文传送的, 如果握手的数据包被破解后, 攻击者恒可能串改数据包, 选择一个安全性较低的加密太监和版本给服务端, 从而对数据进行破坏.<br>
所以, 服务端需要对密文中解密出来的 pre_master_secret 版本号跟之前 Client Hello 阶段的版本号进行比对, 如果版本号变低, 则立即停止发送任何消息.</p>
</li>
<li>
<p>不管客户端还是服务端, 都需要随机数, 这样生成的密钥才不会每次都一样.<br>
由于 TLS/SSL 协议中证书是静态的, 因此十分有必要引入一种随机因素来保证协商出来的密钥的随机性.</p>
<p>对于 RSA 密钥交换算法来说, pre_master_secret 本身就是一个随机数, 再加上 hello 消息中的随机, 三个随机数通过一个密钥导出器最终导出一个对称密钥.</p>
<p>pre_master_secret 的存在在于 SSL 协议不信任每个主机都能产生完全随机的随机数, 如果随机数不随机, 那么 pre_master_secret 就有可能被猜出来, 那么仅适用 pre_master_secret 作为密钥就不合适了, 因此必须引入新的随机因素, 那么客户端和服务器加上 pre_master_secret 三个随机数一同生成的密钥就不容易被猜出了, 一个伪随机可能完全不随机, 可是三个伪随机就十分接近随机了, 每增加一个自由度, 随机性增加的可不是一.</p>
</li>
<li>
<p>对应用层数据进行分片成合适的block<br>
为分片数据编号, 防止重放攻击</p>
</li>
</ul>
<h1 id="https-性能与优化">3.  HTTPS 性能与优化</h1>
<p>HTTPS的优点在于:</p>
<ul>
<li>身份认证, 信息加密和完整性效验, 提高了通信安全性</li>
<li>未对 TCP 和 HTTP 协议做任何改动</li>
</ul>
<p>HTTPS付出代价便是增加了性能损耗, 主要体现在:</p>
<ul>
<li>
<p>增加延时<br>
一次完整的握手至少需要两端来回2次通信, 即至少增加延时 2 * RTT; 即使利用会话缓存从而复用连接, 延时也至少增加 1 * RTT.</p>
</li>
<li>
<p>CPU资源消耗更多<br>
非对称算法 RSA 解密能力是当前困扰HTTPS接入的主要难题.</p>
</li>
</ul>
<h2 id="https-接入优化">3.1.  HTTPS 接入优化</h2>
<ul>
<li>
<p>CDN接入<br>
HTTPS 增加的延时主要是传输延时 RTT, RTT 的特点是节点越近延时越小, CDN 天然离用户最近, 因此选择使用 CDN 作为 HTTPS 接入的入口, 将能够极大减少接入延时.<br>
CDN 节点通过和业务服务器维持长连接, 会话复用和链路质量优化等可控方法, 极大减少 HTTPS 带来的延时.</p>
</li>
<li>
<p>会话缓存<br>
虽然前文提到 HTTPS 即使采用会话缓存也要至少1*RTT的延时, 但是至少延时已经减少为原来的一半, 明显的延时优化;<br>
同时, 基于会话缓存建立的 HTTPS 连接不需要服务器使用 RSA 私钥解密获取 pre_master_secret 信息, 可以省去 CPU 的消耗.<br>
如果业务访问连接集中, 缓存命中率高, 则HTTPS的接入能力讲明显提升.<br>
当前 TRP 平台的缓存命中率高峰时期大于 30%, 10k/s 的接入资源实际可以承载13k/s 的接入, 收效非常可观.</p>
</li>
<li>
<p>硬件加速<br>
为接入服务器安装专用的SSL硬件加速卡, 作用类似 GPU, 释放 CPU, 能够具有更高的 HTTPS 接入能力且不影响业务程序的.<br>
测试某硬件加速卡单卡可以提供35k的解密能力, 相当于175核 CPU, 至少相当于7台24核的服务器, 考虑到接入服务器其它程序的开销, 一张硬件卡可以实现接近10台服务器的接入能力.</p>
</li>
<li>
<p>远程解密<br>
本地接入消耗过多的 CPU 资源, 浪费了网卡和硬盘等资源, 考虑将最消耗 CPU 资源的 RSA 解密计算任务转移到其它服务器, 如此则可以充分发挥服务器的接入能力, 充分利用带宽与网卡资源.<br>
远程解密服务器可以选择 CPU 负载较低的机器充当, 实现机器资源复用, 也可以是专门优化的高计算性能的服务器.<br>
当前也是 CDN 用于大规模HTTPS接入的解决方案之一.</p>
</li>
<li>
<p>SPDY/HTTP2<br>
前面的方法分别从减少传输延时和单机负载的方法提高 HTTPS 接入性能, 但是方法都基于不改变 HTTP 协议的基础上提出的优化方法, SPDY/HTTP2 利用 TLS/SSL 带来的优势, 通过修改协议的方法来提升 HTTPS 的性能, 提高下载速度等.</p>
</li>
</ul>
<h1 id="resource">4.  Resource</h1>
<ul>
<li><a href="https://www.wosign.com/faq/faq2016-0309-01.htm" target="_blank" rel="noopener">https://www.wosign.com/faq/faq2016-0309-01.htm</a></li>
<li><a href="https://segmentfault.com/a/1190000002554673" target="_blank" rel="noopener">https://segmentfault.com/a/1190000002554673</a></li>
</ul>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  


  
  <nav class="pagination">
    <a class="extend prev" rel="prev" href="/page/39/"><i class="fa fa-angle-left" aria-label="上一页"></i></a><a class="page-number" href="/">1</a><span class="space">&hellip;</span><a class="page-number" href="/page/39/">39</a><span class="page-number current">40</span><a class="page-number" href="/page/41/">41</a><span class="space">&hellip;</span><a class="page-number" href="/page/46/">46</a><a class="extend next" rel="next" href="/page/41/"><i class="fa fa-angle-right" aria-label="下一页"></i></a>
  </nav>



          </div>
          

<script>
  window.addEventListener('tabs:register', () => {
    let { activeClass } = CONFIG.comments;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      let activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      let commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script>

        </div>
          
  
  <div class="toggle sidebar-toggle">
    <span class="toggle-line toggle-line-first"></span>
    <span class="toggle-line toggle-line-middle"></span>
    <span class="toggle-line toggle-line-last"></span>
  </div>

  <aside class="sidebar">
    <div class="sidebar-inner">

      <ul class="sidebar-nav motion-element">
        <li class="sidebar-nav-toc">
          文章目录
        </li>
        <li class="sidebar-nav-overview">
          站点概览
        </li>
      </ul>

      <!--noindex-->
      <div class="post-toc-wrap sidebar-panel">
      </div>
      <!--/noindex-->

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <img class="site-author-image" itemprop="image" alt="Raven"
      src="/images/avatar.jpg">
  <p class="site-author-name" itemprop="name">Raven</p>
  <div class="site-description" itemprop="description"></div>
</div>
<div class="site-state-wrap motion-element">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/archives/">
        
          <span class="site-state-item-count">456</span>
          <span class="site-state-item-name">日志</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
            <a href="/categories/">
          
        <span class="site-state-item-count">32</span>
        <span class="site-state-item-name">分类</span></a>
      </div>
      <div class="site-state-item site-state-tags">
            <a href="/tags/">
          
        <span class="site-state-item-count">54</span>
        <span class="site-state-item-name">标签</span></a>
      </div>
  </nav>
</div>
  <div class="links-of-author motion-element">
      <span class="links-of-author-item">
        <a href="https://ravenfu.github.io/" title="GitHub → https:&#x2F;&#x2F;ravenfu.github.io"><i class="github fa-fw"></i>GitHub</a>
      </span>
  </div>



      </div>

    </div>
  </aside>
  <div id="sidebar-dimmer"></div>


      </div>
    </main>

    <footer class="footer">
      <div class="footer-inner">
        

        

<div class="copyright">
  
  &copy; 
  <span itemprop="copyrightYear">2020</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Raven</span>
</div>
  <div class="powered-by">由 <a href="https://hexo.io/" class="theme-link" rel="noopener" target="_blank">Hexo</a> & <a href="https://pisces.theme-next.org/" class="theme-link" rel="noopener" target="_blank">NexT.Pisces</a> 强力驱动
  </div>

        








      </div>
    </footer>
  </div>

  
  <script src="/lib/anime.min.js"></script>
  <script src="//cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script>
  <script src="//cdn.jsdelivr.net/gh/fancyapps/fancybox@3/dist/jquery.fancybox.min.js"></script>
  <script src="/lib/velocity/velocity.min.js"></script>
  <script src="/lib/velocity/velocity.ui.min.js"></script>

<script src="/js/utils.js"></script>

<script src="/js/motion.js"></script>


<script src="/js/schemes/pisces.js"></script>


<script src="/js/next-boot.js"></script>




  




  
<script src="/js/local-search.js"></script>









<script>
document.querySelectorAll('.pdfobject-container').forEach(element => {
  let url = element.dataset.target;
  let pdfOpenParams = {
    navpanes : 0,
    toolbar  : 0,
    statusbar: 0,
    pagemode : 'thumbs',
    view     : 'FitH'
  };
  let pdfOpenFragment = '#' + Object.entries(pdfOpenParams).map(([key, value]) => `${key}=${encodeURIComponent(value)}`).join('&');
  let fullURL = `/lib/pdf/web/viewer?file=${encodeURIComponent(url)}${pdfOpenFragment}`;

  if (NexT.utils.supportsPDFs()) {
    element.innerHTML = `<embed class="pdfobject" src="${url + pdfOpenFragment}" type="application/pdf" style="height: ${element.dataset.height};">`;
  } else {
    element.innerHTML = `<iframe src="${fullURL}" style="height: ${element.dataset.height};" frameborder="0"></iframe>`;
  }
});
</script>




  

  
      
<link rel="stylesheet" href="//cdn.jsdelivr.net/npm/katex@0/dist/katex.min.css">


  

</body>
</html>
